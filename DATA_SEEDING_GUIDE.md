# DocWN Project - Data Seeding Guide

## Overview

This document provides comprehensive information about the DocWN project's data structure, seeding commands, and sample credentials.

## Project Structure

DocWN is a Django-based novel reading platform with the following main applications:

### 1. Accounts App
- **User**: Custom user model with email authentication
- **UserProfile**: Extended user information with avatar, bio, interests
- **User Roles**: GUEST, USER, WEBSITE_ADMIN, SYSTEM_ADMIN

### 2. Novels App
- **Novel**: Main novel entity with metadata, approval status, ratings
- **Author**: Novel authors with biographical information
- **Artist**: Illustrators and cover artists
- **Tag**: Genre and category tags for novels
- **Volume**: Organizational structure for chapters
- **Chapter**: Individual chapters with approval workflow
- **Chunk**: Content pieces within chapters for better loading
- **Favorite**: User's favorite novels
- **ReadingHistory**: User's reading progress tracking

### 3. Interactions App
- **Review**: User reviews with ratings (1-5 stars)
- **Comment**: Comments on novels with reply functionality
- **Notification**: System notifications for user activities
- **Report**: Content reporting system

## Data Model Relationships

```
User ←→ UserProfile (1:1)
User → Novel (1:many, created_by)
User → Review (1:many)
User → Comment (1:many)
User → Favorite (1:many)
User → ReadingHistory (1:many)

Author → Novel (1:many)
Artist → Novel (1:many)
Novel ←→ Tag (many:many)
Novel → Volume (1:many)
Volume → Chapter (1:many)
Chapter → Chunk (1:many)
Chapter → ReadingHistory (1:many)

Novel → Review (1:many)
Novel → Comment (1:many)
```

## Management Commands

### 1. Seed Data Command

**Purpose**: Populate the database with comprehensive test data

**Usage**:
```bash
python manage.py seed_data [options]
```

**Options**:
- `--users N`: Number of users to create (default: 50)
- `--authors N`: Number of authors to create (default: 20)
- `--artists N`: Number of artists to create (default: 15)
- `--tags N`: Number of tags to create (default: 30)
- `--novels N`: Number of novels to create (default: 100)
- `--chapters-per-novel N`: Average chapters per novel (default: 10)
- `--clear`: Clear existing data before seeding

**Examples**:
```bash
# Seed with default values
python manage.py seed_data

# Seed with custom amounts
python manage.py seed_data --users 100 --novels 200

# Clear and seed
python manage.py seed_data --clear --users 50
```

**Generated Data**:
- 50 users with complete profiles
- 20 authors (mix of Vietnamese and international)
- 15 artists
- 30 tags (genres and categories)
- 100 novels with metadata
- Volumes and chapters for each novel
- Reviews, comments, favorites, and reading history
- Realistic relationships and interactions

### 2. Clear Data Command

**Purpose**: Remove all data from the database

**Usage**:
```bash
python manage.py clear_data --confirm
```

**Safety**: Requires `--confirm` flag to prevent accidental deletion
**Preservation**: Superuser accounts are preserved

### 3. Show Data Command

**Purpose**: Display database statistics and sample credentials

**Usage**:
```bash
python manage.py show_data
```

**Output Includes**:
- User statistics (total, active, verified, blocked)
- Content statistics (novels, chapters, reviews, etc.)
- Sample user credentials
- Top novels by views
- Popular tags and authors
- Data quality indicators
- Access URLs

### 4. Setup Groups Command

**Purpose**: Configure Django user groups and permissions

**Usage**:
```bash
python manage.py setup_groups [--reset]
```

## Default Credentials

### Superuser Account
- **Email**: admin@docwn.com
- **Username**: admin
- **Password**: admin123456
- **Role**: SYSTEM_ADMIN

### Sample Regular Users
All seeded users have the password: `password123`

Example users created by seeding:
- Various usernames and emails (generated by Faker)
- Mix of USER and WEBSITE_ADMIN roles
- Complete profiles with avatars and descriptions

## Access URLs

### Main Application
- **Home Page**: `/`
- **Novels List**: `/novels/`
- **User Registration**: `/accounts/register/`
- **User Login**: `/accounts/login/`

### Admin Interface
- **Admin Panel**: `/admin/`
- **User Management**: `/admin/accounts/user/`
- **Novel Management**: `/admin/novels/novel/`
- **Reviews**: `/admin/interactions/review/`

## Database Schema

### Key Models and Fields

#### User Model
```python
- email (EmailField, unique)
- username (CharField, unique)
- is_blocked (BooleanField)
- role (CharField, choices)
- is_email_verified (BooleanField)
- date_joined (DateTimeField)
```

#### Novel Model
```python
- name (CharField)
- slug (SlugField, unique)
- summary (TextField)
- author (ForeignKey to Author)
- artist (ForeignKey to Artist)
- tags (ManyToManyField to Tag)
- progress_status (CharField, choices: ONGOING/COMPLETED/SUSPEND)
- approval_status (CharField, choices: DRAFT/PENDING/APPROVED/REJECTED)
- view_count (IntegerField)
- favorite_count (IntegerField)
- rating_avg (FloatField)
- created_by (ForeignKey to User)
```

#### Chapter Model
```python
- volume (ForeignKey to Volume)
- title (CharField)
- slug (SlugField, unique)
- position (IntegerField)
- word_count (IntegerField)
- view_count (IntegerField)
- approved (BooleanField)
- is_hidden (BooleanField)
```

## Data Seeding Details

### User Data
- **Profiles**: Complete with display names, avatars (Pravatar), and interests
- **Roles**: Realistic distribution (mostly USER, some WEBSITE_ADMIN)
- **Status**: 75% active, 25% blocked, 66% email verified

### Novel Data
- **Titles**: Mix of Vietnamese classics and international literature
- **Content**: Vietnamese and English titles with realistic summaries
- **Authors**: Famous Vietnamese authors + international writers
- **Tags**: Comprehensive genre system (Fantasy, Romance, Sci-Fi, etc.)
- **Images**: Generated using Picsum for consistent quality

### Content Structure
- **Volumes**: 1-3 volumes per novel
- **Chapters**: 5-10 chapters per volume
- **Chunks**: 3-8 content chunks per chapter
- **Approval**: Realistic approval workflow simulation

### Interactions
- **Reviews**: Users review novels with 1-5 star ratings
- **Comments**: Novel discussions with like counts
- **Favorites**: User favorite novel collections
- **Reading History**: Tracking reading progress

## Development Workflow

### Initial Setup
```bash
# Install dependencies
pip install -r requirements.txt

# Run migrations
python manage.py migrate

# Setup user groups
python manage.py setup_groups

# Seed data
python manage.py seed_data

# Create additional superuser (optional)
python manage.py createsuperuser
```

### Testing and Development
```bash
# View current data
python manage.py show_data

# Clear and reseed
python manage.py clear_data --confirm
python manage.py seed_data

# Run development server
python manage.py runserver
```

### Production Considerations
- Set `DEBUG = False`
- Configure proper database (PostgreSQL/MySQL)
- Set up static file serving
- Configure email backend for notifications
- Set secure secret keys and credentials

## Sample Data Statistics

After running `seed_data` with defaults:
- **Users**: 50 users with complete profiles
- **Content**: 100 novels, ~200 volumes, ~1000 chapters
- **Interactions**: ~200 reviews, ~500 comments, ~300 favorites
- **Quality**: All novels have content, users have profiles, realistic interactions

## Troubleshooting

### Common Issues
1. **Foreign Key Constraints**: Use `clear_data` before seeding
2. **Unique Constraints**: Faker generates unique data, but conflicts may occur
3. **Permission Errors**: Run `setup_groups` after clearing data

### Performance Considerations
- Large datasets: Use smaller numbers for testing
- Database performance: Consider indexes for production
- Memory usage: Bulk operations used for efficiency

## Extensions and Customization

### Adding More Data Types
1. Create new management command in appropriate app
2. Follow the pattern of `seed_data.py`
3. Use Faker for realistic test data
4. Implement proper foreign key relationships

### Customizing Sample Data
- Modify the data lists in `seed_data.py`
- Adjust probability distributions
- Add more realistic Vietnamese content
- Implement specific test scenarios

## Security Notes

- **Default Passwords**: Change in production
- **Test Data**: Never use seeded data in production
- **Permissions**: Review user roles and permissions
- **Data Privacy**: Generated data is for testing only

---

**Last Updated**: August 28, 2025
**Version**: 1.0
**Project**: DocWN - Novel Reading Platform
